<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>찜한 상품 관리</title>
    <link rel="stylesheet" href="styles.css">
    <style>
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f4f7fc;
        margin: 0;
        padding: 20px;
    }
    
    .wishlist-container {
        width: 80%;
        margin: auto;
    }
    
    .wishlist h1 {
        color: #333;
    }
    
    .wishlist {
        list-style: none;
        padding: 0;
    }
    
    .wishlist li {
        background-color: #fff;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
    }
    
    .product-image {
        width: 100px;
        height: 100px;
        margin-right: 20px;
        border-radius: 5px;
    }
    
    .item-info {
        flex-grow: 1;
    }
    
    .item-info h2 {
        margin: 0 0 10px 0;
        color: #2196F3;
    }
    
    .item-info p {
        margin: 0;
        font-size: 16px;
    }
    
    button {
        padding: 10px 20px;
        background-color: #E91E63;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    button:hover {
        background-color: #C2185B;
    }
    </style>
    <script>
	    function removeFromWishlist(productId) {
	        if (!confirm('이 상품을 찜 목록에서 삭제하시겠습니까?')) {
	            return;  // 사용자가 취소 선택 시 작업 중단
	        }
	
	        fetch(`/api/wishlist/remove/${productId}`, {
	            method: 'DELETE'
	        })
	        .then(response => {
	            if (response.ok) {
	                document.getElementById(`item-${productId}`).remove();  // DOM에서 해당 아이템 삭제
	                alert('상품이 찜 목록에서 삭제되었습니다.');
	            } else {
	                throw new Error('Failed to remove from wishlist');
	            }
	        })
	        .catch(error => {
	            console.error('Error removing product from wishlist:', error);
	            alert('상품 삭제 중 오류가 발생했습니다.');
	        });
	    }
    </script>
</head>
<body>
    <div class="wishlist-container">
        <h1>찜한 상품</h1>
        <ul class="wishlist" th:each="item : ${wishlistItems}">
            <li th:id="'item-' + ${item.product.productId}">
                <div class="item">
                    <img th:src="@{${item.product.imageUrl}}" alt="Product Image" class="product-image">
                    <div class="item-info">
                        <h2 th:text="${item.product.productName}">상품명</h2>
                        <p th:text="${item.product.price} + '원'">가격</p>
                        <button th:attr="onclick='removeFromWishlist(' + ${item.id} + ');'">삭제</button>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</body>
</html>
